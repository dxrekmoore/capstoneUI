{"ast":null,"code":"var _jsxFileName = \"/home/soundmapper/test/capstoneUI/src/uploading/client/src/components/Record/record.js\";\nimport React from 'react';\nimport './record.css';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128\n}); //export const lat =  0;\n//export const long =  0;\n//export const mp3file =  0;\n\nexport var lat;\nexport var long;\nexport var mp3file; //export const newVar = mp3file;\n\nnavigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia; // Older browsers might not implement mediaDevices at all, so we set an empty object first\n\nif (navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n} // Some browsers partially implement mediaDevices. We can't just assign an object\n// with getUserMedia as it would overwrite existing properties.\n// Here, we will just add the getUserMedia property if it's missing.\n\n\nif (navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = function (constraints) {\n    // First get ahold of the legacy getUserMedia, if present\n    var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia; // Some browsers just don't implement it - return a rejected promise with an error\n    // to keep a consistent interface\n\n    if (!getUserMedia) {\n      return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n    } // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n\n\n    return new Promise(function (resolve, reject) {\n      getUserMedia.call(navigator, constraints, resolve, reject);\n    });\n  };\n}\n\nfunction success(pos) {\n  var crd = pos.coords;\n  lat = crd.latitude;\n  long = crd.longitude;\n}\n\nfunction error(err) {\n  console.warn(`ERROR(${err.code}): ${err.message}`);\n}\n\nif (window.navigator.geolocation) {\n  //get location on recording start\n  window.navigator.geolocation.getCurrentPosition(success, error);\n}\n\nclass Record extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.start = () => {\n      if (this.state.isBlocked) {\n        //mic not enabled\n        console.log('Permission Denied');\n      } else {\n        //start recording\n        Mp3Recorder.start().then(() => {\n          this.setState({\n            isRecording: true\n          });\n        }).catch(e => console.error(e));\n      }\n    };\n\n    this.stop = () => {\n      //stop recording clicked\n      Mp3Recorder.stop().getMp3().then(_ref => {\n        let [buffer, blob] = _ref;\n        const blobURL = URL.createObjectURL(blob);\n        mp3file = new File([blob], \"audiofile.mp3\");\n        this.setState({\n          blobURL,\n          isRecording: false\n        });\n        console.log('mp3file');\n        console.log(mp3file);\n        console.log(\"lat: \" + lat);\n        console.log(\"long: \" + long);\n      }).catch(e => console.log(e));\n    };\n\n    this.state = {\n      isRecording: false,\n      blobURL: '',\n      isBlocked: false\n    };\n  }\n\n  componentDidMount() {\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }, () => {\n      console.log('Permission Granted');\n      this.setState({\n        isBlocked: false\n      });\n    }, () => {\n      console.log('Permission Denied');\n      this.setState({\n        isBlocked: true\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: /*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"App-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.start,\n          disabled: this.state.isRecording,\n          children: \"Record\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.stop,\n          disabled: !this.state.isRecording,\n          children: \"Stop\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n          src: this.state.blobURL,\n          controls: \"controls\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Record;","map":{"version":3,"sources":["/home/soundmapper/test/capstoneUI/src/uploading/client/src/components/Record/record.js"],"names":["React","MicRecorder","Mp3Recorder","bitRate","lat","long","mp3file","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","mediaDevices","undefined","constraints","Promise","reject","Error","resolve","call","success","pos","crd","coords","latitude","longitude","error","err","console","warn","code","message","window","geolocation","getCurrentPosition","Record","Component","constructor","props","start","state","isBlocked","log","then","setState","isRecording","catch","e","stop","getMp3","buffer","blob","blobURL","URL","createObjectURL","File","componentDidMount","audio","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './record.css';\nimport MicRecorder from 'mic-recorder-to-mp3';\n\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\n//export const lat =  0;\n//export const long =  0;\n//export const mp3file =  0;\nexport var lat;\nexport var long;\nexport var mp3file;\n\n//export const newVar = mp3file;\n\nnavigator.getUserMedia =  navigator.getUserMedia ||\nnavigator.webkitGetUserMedia ||\nnavigator.mozGetUserMedia ||\nnavigator.msGetUserMedia\n\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nif (navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n}\n\n// Some browsers partially implement mediaDevices. We can't just assign an object\n// with getUserMedia as it would overwrite existing properties.\n// Here, we will just add the getUserMedia property if it's missing.\nif (navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = function(constraints) {\n\n    // First get ahold of the legacy getUserMedia, if present\n    var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\n    // Some browsers just don't implement it - return a rejected promise with an error\n    // to keep a consistent interface\n    if (!getUserMedia) {\n      return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n    }\n\n    // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n    return new Promise(function(resolve, reject) {\n      getUserMedia.call(navigator, constraints, resolve, reject);\n    });\n  }\n}\n\n\nfunction success(pos){\n  var crd = pos.coords;\n  lat = crd.latitude;\n  long = crd.longitude;\n}\nfunction error(err){\n  console.warn(`ERROR(${err.code}): ${err.message}`);\n}\nif (window.navigator.geolocation) { //get location on recording start\n  window.navigator.geolocation\n  .getCurrentPosition(success, error);\n\n } \n\n\n\nclass Record extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      isRecording: false,\n      blobURL: '',\n      isBlocked: false,\n    };\n  }\n  \n  start = () => {\n\n    if (this.state.isBlocked) { //mic not enabled\n      console.log('Permission Denied');\n    } else { //start recording\n      Mp3Recorder\n        .start()\n        .then(() => {\n          this.setState({ isRecording: true });\n        }).catch((e) => console.error(e));\n    }\n  };\n  \n\n  stop = () => { //stop recording clicked\n    Mp3Recorder\n      .stop()\n      .getMp3()\n      .then(([buffer, blob]) => {\n        const blobURL = URL.createObjectURL(blob);\n        mp3file = new File([blob], \"audiofile.mp3\");\n        this.setState({ blobURL, isRecording: false });\n\n        console.log('mp3file');\n        console.log(mp3file);\n\n        console.log(\"lat: \" + lat);\n        console.log(\"long: \" + long);\n        \n\n        \n      }).catch((e) => console.log(e));\n  };\n  \n\n\n  componentDidMount() {\n\n    navigator.mediaDevices.getUserMedia({ audio: true },\n      () => {\n        console.log('Permission Granted');\n        this.setState({ isBlocked: false });\n      },\n      () => { \n        console.log('Permission Denied');\n        this.setState({ isBlocked: true })\n      },\n    );\n  }\n\n\n  render(){\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <button onClick={this.start} disabled={this.state.isRecording}>Record</button>\n          <button onClick={this.stop} disabled={!this.state.isRecording}>Stop</button>\n          <audio src={this.state.blobURL} controls=\"controls\" />\n        </header>\n      </div>\n    );\n  }\n}\n\nexport default Record;\n"]},"metadata":{},"sourceType":"module"}